if(CMAKE_GENERATOR MATCHES "Visual Studio")
  enable_language(CSharp)
  add_library(PSWinPrefs SHARED LibPrefs.cs RegisterSavePreferencesScheduledTask.cs SavePreferences.cs
                              UnregisterSavePreferencesScheduledTask.cs WriteRegCommands.cs)
  set_target_properties(PSWinPrefs PROPERTIES DOTNET_SDK "Microsoft.NET.Sdk" DOTNET_TARGET_FRAMEWORK "net6.0" VS_GLOBAL_EnforceCodeStyleInBuild True VS_GLOBAL_ImplicitUsings enable VS_GLOBAL_Nullable enable)
  target_compile_options(PSWinPrefs PRIVATE "/unsafe")
  set_property(TARGET PSWinPrefs PROPERTY VS_PACKAGE_REFERENCES "ILRepack_2.0.18;Microsoft.PowerShell.SDK_7.2.7;TaskScheduler_2.10.1")
  install(TARGETS PSWinPrefs winprefsw prefs DESTINATION WinPrefs)
   install(FILES WinPrefs.dll DESTINATION WinPrefs)
endif()
